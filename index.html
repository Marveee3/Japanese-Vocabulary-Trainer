<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–Ø–ø–æ–Ω—Å–∫–∏–π Vocabulary Trainer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #e74c3c;
            --primary-dark: #c0392b;
            --secondary: #2c3e50;
            --accent: #3498db;
            --light: #18f3ff;
            --dark: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #ff2b14;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius: 8px;
            --transition: all 0.3s ease;
            --header-height: 70px;
            --footer-height: 60px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f4f8ff 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--dark);
            padding: 0;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            width: 100%;
        }

        /* Header */
        header {
            background: rgb(255, 255, 255);
            padding: 15px 20px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            font-size: 2rem;
            color: var(--primary);
        }

        .logo-text h1 {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 0;
        }

        .logo-text p {
            font-size: 0.8rem;
            color: #7f8c8d;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--dark);
            cursor: pointer;
            padding: 5px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            background: rgb(255, 255, 246);
            border-radius: var(--radius);
            padding: 10px;
            box-shadow: var(--shadow);
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 12px 15px;
            background: #4fdfff;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            border: 2px solid transparent;
            text-align: center;
            font-size: 0.9rem;
        }

        .tab:hover {
            background: var(--light);
            transform: translateY(-2px);
        }

        .tab.active {
            background: var(--primary);
            color: rgb(255, 255, 255);
            border-color: var(--primary-dark);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            background: rgb(255, 255, 246);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            animation: fadeIn 0.4s ease;
            margin-bottom: 20px;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Typography */
        .section-title {
            margin-bottom: 20px;
            color: var(--secondary);
            border-bottom: 2px solid var(--light);
            padding-bottom: 10px;
            font-size: 1.5rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: var(--radius);
            font-size: 16px;
            transition: var(--transition);
        }

        input:focus, textarea:focus, select:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Range Slider */
        .range-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }

        .range-slider {
            flex: 1;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 4px;
            background: #ddd;
            outline: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: 2px solid white;
            box-shadow: var(--shadow);
        }

        .range-value {
            min-width: 50px;
            text-align: center;
            font-weight: bold;
            color: var(--primary);
        }

        /* Settings Panel */
        .settings-panel {
            background: #f8f9fa;
            border-radius: var(--radius);
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid var(--accent);
        }

        .settings-group {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeaea;
        }

        .settings-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .settings-group h4 {
            margin-bottom: 15px;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-group h4 i {
            color: var(--accent);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px;
            border-radius: 5px;
            transition: var(--transition);
        }

        .checkbox-item:hover {
            background: rgba(52, 152, 219, 0.05);
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-weight: normal;
            flex: 1;
        }

        /* Buttons */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: var(--radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-block;
            text-align: center;
            font-size: 16px;
            min-height: 44px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: #1a252f;
            transform: translateY(-2px);
        }

        .btn-accent {
            background: var(--accent);
            color: white;
        }

        .btn-accent:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        /* –ö–Ω–æ–ø–∫–∞ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è */
        .speak-btn {
            background: none;
            border: none;
            color: var(--accent);
            cursor: pointer;
            font-size: 1.2rem;
            margin-left: 10px;
            padding: 5px;
            transition: var(--transition);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            vertical-align: middle;
        }

        .speak-btn:hover {
            background: rgba(52, 152, 219, 0.1);
            transform: scale(1.1);
        }

        .speak-btn:active {
            transform: scale(0.95);
        }

        .speak-btn-small {
            font-size: 1rem;
            width: 35px;
            height: 35px;
            margin-left: 5px;
        }

        .speak-btn.speaking {
            color: var(--primary);
            background: rgba(231, 76, 60, 0.1);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Stats Cards */
        .cards-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: var(--light);
            padding: 15px 20px;
            border-radius: var(--radius);
            text-align: center;
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }

        /* Study Mode */
        .study-mode {
            text-align: center;
            padding: 20px;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .prompt {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--secondary);
            min-height: 50px;
            line-height: 1.5;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .prompt-text {
            display: inline-block;
        }

        .answer-area {
            margin: 20px 0;
        }

        .answer-input {
            font-size: 1.2rem;
            text-align: center;
            padding: 15px;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .option {
            padding: 15px;
            background: var(--light);
            border-radius: var(--radius);
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid transparent;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .option:hover {
            background: #c0e2ef;
            transform: translateY(-2px);
        }

        .option.correct {
            background: #44fa93;
            border-color: var(--success);
        }

        .option.incorrect {
            background: #c65046;
            border-color: var(--danger);
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: var(--radius);
            font-weight: 600;
            text-align: center;
        }

        .feedback.correct {
            background: #d5f5e3;
            color: var(--success);
        }

        .feedback.incorrect {
            background: #fadbd8;
            color: var(--danger);
        }

        /* Card List */
        .card-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: var(--radius);
            margin-top: 20px;
        }

        .card-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .card-item:nth-child(even) {
            background: #f9f9f9;
        }

        .card-item:hover {
            background: #f0f7ff;
        }

        .card-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .card-actions {
            display: flex;
            gap: 5px;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 0.8rem;
            min-height: auto;
        }

        /* Decks */
        .deck-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .deck-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            padding: 15px;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            box-shadow: var(--shadow);
        }

        .deck-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .deck-card.active {
            border-color: var(--success);
            background: #f0fff0;
        }

        .deck-card.completed {
            border-color: var(--primary);
            background: #fff5f5;
            opacity: 0.9;
        }

        .deck-card h4 {
            margin-bottom: 5px;
            color: var(--secondary);
        }

        .deck-card .progress {
            height: 6px;
            background: #eee;
            border-radius: 3px;
            margin: 10px 0;
            overflow: hidden;
        }

        .deck-card .progress .fill {
            height: 100%;
            background: var(--success);
            width: 0%;
        }

        /* Instructions */
        .instructions {
            background: #f8f9fa;
            padding: 15px;
            border-radius: var(--radius);
            margin: 20px 0;
            border-left: 4px solid var(--accent);
        }

        .instructions h3 {
            margin-bottom: 10px;
            color: var(--secondary);
        }

        .instructions ul {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 5px;
            line-height: 1.5;
        }

        /* Progress */
        .progress-bar {
            height: 8px;
            background: #eee;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Utility */
        .hidden {
            display: none !important;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #7f8c8d;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        /* Footer */
        footer {
            background: var(--secondary);
            color: white;
            padding: 15px 20px;
            text-align: center;
            margin-top: auto;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            flex-wrap: wrap;
        }

        .footer-stats {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .footer-stats span {
            font-weight: bold;
            color: var(--light);
        }

        /* Mobile Navigation */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
            padding: 10px;
        }

        .mobile-nav-tabs {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .mobile-tab {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            color: #7f8c8d;
            text-decoration: none;
            font-size: 0.8rem;
            flex: 1;
        }

        .mobile-tab.active {
            color: var(--primary);
        }

        .mobile-tab i {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        /* Continue Group */
        #continue-group {
            margin-top: 20px;
            display: none;
        }

        #continue-group.show {
            display: flex;
        }

        /* ========== MEDIA QUERIES ========== */
        
        /* –ü–ª–∞–Ω—à–µ—Ç—ã –∏ –Ω–µ–±–æ–ª—å—à–∏–µ –Ω–æ—É—Ç–±—É–∫–∏ */
        @media (max-width: 992px) {
            .container {
                padding: 15px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .deck-list {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .options {
                grid-template-columns: 1fr;
            }
        }

        /* –ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–ø–æ—Ä—Ç—Ä–µ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è) */
        @media (max-width: 768px) {
            .logo-text h1 {
                font-size: 1.2rem;
            }
            
            .logo-text p {
                font-size: 0.7rem;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .tabs {
                display: none;
            }
            
            .mobile-nav {
                display: block;
            }
            
            .tab-content {
                padding: 15px;
                margin-bottom: 80px;
            }
            
            .section-title {
                font-size: 1.3rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .cards-stats {
                grid-template-columns: 1fr;
            }
            
            .stat-card {
                padding: 12px 15px;
            }
            
            .stat-value {
                font-size: 1.7rem;
            }
            
            .deck-list {
                grid-template-columns: 1fr;
            }
            
            .card-list {
                max-height: 300px;
            }
            
            .study-mode {
                padding: 15px;
            }
            
            .prompt {
                font-size: 1.1rem;
                flex-direction: column;
                gap: 5px;
            }
            
            .answer-input {
                font-size: 1rem;
                padding: 12px;
            }
            
            .option {
                padding: 12px;
                font-size: 0.95rem;
            }
            
            .speak-btn {
                width: 36px;
                height: 36px;
                font-size: 1.1rem;
            }
            
            .footer-content {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .settings-panel {
                padding: 15px;
            }
            
            .range-container {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
        }

        /* –ú–∞–ª–µ–Ω—å–∫–∏–µ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ */
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            
            .tab-content {
                padding: 12px;
            }
            
            .section-title {
                font-size: 1.2rem;
            }
            
            .stat-card {
                padding: 10px 12px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
            
            .logo-icon {
                font-size: 1.5rem;
            }
            
            .logo-text h1 {
                font-size: 1rem;
            }
            
            .mobile-tab span {
                font-size: 0.7rem;
            }
            
            .mobile-tab i {
                font-size: 1rem;
            }
            
            .card-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .card-info {
                width: 100%;
            }
            
            .card-actions {
                align-self: flex-end;
            }
            
            .instructions {
                padding: 12px;
            }
            
            .instructions ul {
                padding-left: 15px;
            }
        }

        /* –õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (max-width: 768px) and (orientation: landscape) {
            .tab-content {
                margin-bottom: 0;
            }
            
            .mobile-nav {
                display: none;
            }
            
            .tabs {
                display: flex;
                flex-direction: row;
                flex-wrap: nowrap;
                overflow-x: auto;
                padding: 8px;
            }
            
            .tab {
                min-width: 100px;
                font-size: 0.8rem;
                padding: 10px;
            }
            
            .card-list {
                max-height: 200px;
            }
        }

        /* –ë–æ–ª—å—à–∏–µ —ç–∫—Ä–∞–Ω—ã */
        @media (min-width: 1200px) {
            .container {
                max-width: 1400px;
            }
            
            .deck-list {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">
            <div class="logo-icon">üìö</div>
            <div class="logo-text">
                <h1>–Ø–ø–æ–Ω—Å–∫–∏–π Vocabulary Trainer</h1>
                <p>–ò–∑—É—á–∞–π—Ç–µ —è–ø–æ–Ω—Å–∫–∏–µ —Å–ª–æ–≤–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ</p>
            </div>
        </div>
        <button class="mobile-menu-btn" id="mobile-menu-btn">
            <i class="fas fa-bars"></i>
        </button>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="container">
        <!-- Desktop Tabs -->
        <div class="tabs" id="desktop-tabs">
            <div class="tab active" data-tab="dashboard">
                <i class="fas fa-home"></i> –ì–ª–∞–≤–Ω–∞—è
            </div>
            <div class="tab" data-tab="add">
                <i class="fas fa-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–∞
            </div>
            <div class="tab" data-tab="study">
                <i class="fas fa-graduation-cap"></i> –û–±—É—á–µ–Ω–∏–µ
            </div>
            <div class="tab" data-tab="manage">
                <i class="fas fa-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="tab-content active" id="dashboard">
            <h2 class="section-title">–û–±–∑–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã</h2>
            <div class="instructions">
                <h3><i class="fas fa-info-circle"></i> –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:</h3>
                <ul>
                    <li><strong>–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–∞:</strong> –í—Ä—É—á–Ω—É—é –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª .txt/.csv</li>
                    <li><strong>–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:</strong> —è–ø–æ–Ω—Å–∫–æ–µ —Å–ª–æ–≤–æ, –ø–µ—Ä–µ–≤–æ–¥ (–ø—Ä–∏–º–µ—Ä: „Å≠„Åì, –∫–æ—à–∫–∞)</li>
                    <li><strong>–†–µ–∂–∏–º—ã –æ–±—É—á–µ–Ω–∏—è:</strong> –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –≤–≤–æ–¥ –∏ –≤—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</li>
                    <li><strong>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</strong> –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫</li>
                </ul>
            </div>

            <div class="instructions">
                <h3><i class="fas fa-volume-up"></i> –û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ —Å–ª–æ–≤:</h3>
                <ul>
                    <li>–î–ª—è –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è —è–ø–æ–Ω—Å–∫–∏—Ö —Å–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É <i class="fas fa-volume-up"></i></li>
                    <li>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏"</li>
                    <li>–§—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö Chrome –∏ Edge</li>
                </ul>
            </div>

            <div class="cards-stats">
                <div class="stat-card">
                    <div class="stat-value" id="total-cards">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∫–∞—Ä—Ç–æ—á–µ–∫</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="study-progress">0%</div>
                    <div class="stat-label">–ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="today-count">0</div>
                    <div class="stat-label">–ò–∑—É—á–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</div>
                </div>
            </div>

            <div class="instructions">
                <h3><i class="fas fa-gamepad"></i> –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ–∂–∏–º—ã –æ–±—É—á–µ–Ω–∏—è:</h3>
                <ul>
                    <li><strong>–í–≤–æ–¥ —Å–ª–æ–≤–∞:</strong> –ù–∞–ø–∏—à–∏—Ç–µ —Å–ª–æ–≤–æ –Ω–∞ —è–ø–æ–Ω—Å–∫–æ–º –ø–æ —Ä—É—Å—Å–∫–æ–º—É –ø–µ—Ä–µ–≤–æ–¥—É</li>
                    <li><strong>–í–≤–æ–¥ –ø–µ—Ä–µ–≤–æ–¥–∞:</strong> –ù–∞–ø–∏—à–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–æ–º –ø–æ —è–ø–æ–Ω—Å–∫–æ–º—É —Å–ª–æ–≤—É</li>
                    <li><strong>–í—ã–±–æ—Ä –ø–µ—Ä–µ–≤–æ–¥–∞:</strong> –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</li>
                    <li><strong>–í—ã–±–æ—Ä —Å–ª–æ–≤–∞:</strong> –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</li>
                </ul>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" id="btn-add-words">
                    <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–∞
                </button>
                <button class="btn btn-accent" id="btn-start-study">
                    <i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ
                </button>
            </div>
        </div>

        <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ–≤ -->
        <div class="tab-content" id="add">
            <h2 class="section-title">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞</h2>
            
            <div class="form-group">
                <label for="manual-japanese"><i class="fas fa-language"></i> –Ø–ø–æ–Ω—Å–∫–æ–µ —Å–ª–æ–≤–æ</label>
                <input type="text" id="manual-japanese" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –Ω–∞ —è–ø–æ–Ω—Å–∫–æ–º">
            </div>
            
            <div class="form-group">
                <label for="manual-russian"><i class="fas fa-font"></i> –†—É—Å—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥</label>
                <input type="text" id="manual-russian" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–æ–º">
            </div>
            
            <button class="btn btn-primary" id="btn-add-manual">
                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é
            </button>
            
            <hr style="margin: 25px 0; border: 0; border-top: 1px solid #eee;">
            
            <!-- –ù–û–í–ê–Ø –°–ï–ö–¶–ò–Ø: –ì–æ—Ç–æ–≤—ã–µ –Ω–∞–±–æ—Ä—ã —Å–ª–æ–≤ -->
            <h3><i class="fas fa-book"></i> –ì–æ—Ç–æ–≤—ã–µ –Ω–∞–±–æ—Ä—ã —Å–ª–æ–≤</h3>
            <div class="instructions">
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä —Å–ª–æ–≤ –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —É—á–µ–±–Ω–∏–∫–æ–≤ —è–ø–æ–Ω—Å–∫–æ–≥–æ —è–∑—ã–∫–∞:</p>
            </div>
            
            <div class="btn-group" style="margin-bottom: 20px;">
                <button class="btn btn-success" id="btn-load-minna">
                    <i class="fas fa-download"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å Minna no Nihongo (–ì—Ä–∞–º–º. –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π 1)
                </button>
            </div>
            
            <div id="minna-load-status" class="feedback hidden"></div>
            
            <hr style="margin: 25px 0; border: 0; border-top: 1px solid #eee;">
            
            <h3><i class="fas fa-file-upload"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞</h3>
            <div class="instructions">
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .txt –∏–ª–∏ .csv –≤ —Ñ–æ—Ä–º–∞—Ç–µ: <br>
                <strong>—è–ø–æ–Ω—Å–∫–æ–µ_—Å–ª–æ–≤–æ, —Ä—É—Å—Å–∫–∏–π_–ø–µ—Ä–µ–≤–æ–¥</strong><br>
                –ü—Ä–∏–º–µ—Ä: <code>„Å≠„Åì, –∫–æ—à–∫–∞</code></p>
            </div>
            
            <div class="upload-area" id="upload-area">
                <p><i class="fas fa-cloud-upload-alt" style="font-size: 2rem; margin-bottom: 10px;"></i></p>
                <p>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—é–¥–∞ —Ñ–∞–π–ª –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
                <input type="file" id="file-input" accept=".txt,.csv" class="hidden">
            </div>
            
            <div id="file-preview" class="hidden">
                <h3>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫)</h3>
                <pre id="preview-content" style="background: #f8f9fa; padding: 15px; border-radius: var(--radius); overflow-x: auto;"></pre>
                <button class="btn btn-success" id="btn-import-file">
                    <i class="fas fa-file-import"></i> –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ
                </button>
            </div>

            <div id="add-feedback" class="feedback hidden"></div>
        </div>

        <!-- –†–µ–∂–∏–º—ã –æ–±—É—á–µ–Ω–∏—è -->
        <div class="tab-content" id="study">
            <h2 class="section-title">–†–µ–∂–∏–º—ã –æ–±—É—á–µ–Ω–∏—è</h2>
            
            <div id="deck-selection" class="hidden">
                <h3><i class="fas fa-layer-group"></i> –í—ã–±–æ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏</h3>
                <div class="instructions">
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è. –ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç 10 —Å–ª–æ–≤.</p>
                    <p>–°–ª–æ–≤–∞ –±—É–¥—É—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è, –ø–æ–∫–∞ –≤—ã –Ω–µ –≤—ã—É—á–∏—Ç–µ –∏—Ö –≤—Å–µ –∏–¥–µ–∞–ª—å–Ω–æ.</p>
                </div>
                <div class="deck-list" id="deck-list"></div>
            </div>

            <div id="study-selection">
                <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è:</p>
                <div class="btn-group">
                    <button class="btn btn-primary" data-mode="input-jp">
                        <i class="fas fa-keyboard"></i> –í–≤–æ–¥ —Å–ª–æ–≤–∞
                    </button>
                    <button class="btn btn-accent" data-mode="input-ru">
                        <i class="fas fa-language"></i> –í–≤–æ–¥ –ø–µ—Ä–µ–≤–æ–¥–∞
                    </button>
                    <button class="btn btn-secondary" data-mode="select-ru">
                        <i class="fas fa-list-ol"></i> –í—ã–±–æ—Ä –ø–µ—Ä–µ–≤–æ–¥–∞
                    </button>
                    <button class="btn btn-success" data-mode="select-jp">
                        <i class="fas fa-check-circle"></i> –í—ã–±–æ—Ä —Å–ª–æ–≤–∞
                    </button>
                </div>
                <div class="instructions" style="margin-top: 20px;">
                    <p><i class="fas fa-info-circle"></i> –î–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è —É –≤–∞—Å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 4 –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –±–∞–∑–µ.</p>
                    <p><i class="fas fa-volume-up"></i> –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ" ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏".</p>
                </div>
            </div>

            <div id="deck-info" class="deck-info hidden">
                <h3 id="deck-title"><i class="fas fa-bookmark"></i> –¢–µ–∫—É—â–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞</h3>
                <div class="deck-current" id="deck-current">
                    <strong>–ü—Ä–æ–≥—Ä–µ—Å—Å:</strong> <span id="deck-progress">0/10</span>
                    <span id="deck-streak" style="margin-left: 20px; color: var(--success); font-weight: bold;"></span>
                </div>
                <div class="deck-stats">
                    <div class="deck-stat">–í—Å–µ–≥–æ —Å–ª–æ–≤: <span id="deck-total">0</span></div>
                    <div class="deck-stat">–û—à–∏–±–æ–∫: <span id="deck-errors">0</span></div>
                    <div class="deck-stat">–°–µ—Ä–∏—è: <span id="deck-current-streak">0</span></div>
                </div>
                <div class="deck-controls">
                    <button class="btn btn-secondary" id="btn-change-deck">
                        <i class="fas fa-exchange-alt"></i> –°–º–µ–Ω–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
                    </button>
                    <button class="btn btn-danger" id="btn-stop-deck">
                        <i class="fas fa-stop"></i> –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
                    </button>
                </div>
            </div>

            <div id="study-area" class="hidden">
                <div class="progress-bar">
                    <div class="progress-fill" id="study-progress-fill"></div>
                </div>
                
                <div class="study-mode">
                    <div class="prompt" id="study-prompt"></div>
                    
                    <div class="answer-area" id="input-area">
                        <input type="text" id="study-input" class="answer-input" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç">
                        <div class="btn-group">
                            <button class="btn btn-primary" id="btn-check-answer">
                                <i class="fas fa-check"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
                            </button>
                            <button class="btn btn-secondary" id="btn-show-answer">
                                <i class="fas fa-eye"></i> –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç
                            </button>
                            <button class="btn btn-danger" id="btn-skip">
                                <i class="fas fa-forward"></i> –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
                            </button>
                        </div>
                    </div>
                    
                    <div class="options" id="options-area"></div>
                    
                    <div id="study-feedback" class="feedback hidden"></div>
                    
                    <div class="btn-group" id="continue-group">
                        <button class="btn btn-primary" id="btn-continue">
                            <i class="fas fa-arrow-right"></i> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
                        </button>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" id="btn-back-to-modes">
                        <i class="fas fa-arrow-left"></i> –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Ä–µ–∂–∏–º
                    </button>
                    <button class="btn btn-danger" id="btn-stop-study">
                        <i class="fas fa-stop"></i> –ó–∞–∫–æ–Ω—á–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ
                    </button>
                </div>
            </div>
        </div>

        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ -->
        <div class="tab-content" id="manage">
            <h2 class="section-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏</h2>
            
            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏ -->
            <div class="settings-panel">
                <h3 class="section-title"><i class="fas fa-volume-up"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏</h3>
                
                <div class="settings-group">
                    <h4><i class="fas fa-tachometer-alt"></i> –°–∫–æ—Ä–æ—Å—Ç—å –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è</h4>
                    <div class="form-group">
                        <div class="range-container">
                            <span style="min-width: 80px;">–ú–µ–¥–ª–µ–Ω–Ω–æ</span>
                            <input type="range" id="speech-rate" class="range-slider" min="0.5" max="2" step="0.1" value="1.0">
                            <span style="min-width: 80px;">–ë—ã—Å—Ç—Ä–æ</span>
                            <div class="range-value" id="rate-value">1.0</div>
                        </div>
                    </div>
                </div>
                
                <div class="settings-group" id="voice-selection-container" style="display: none;">
                    <h4><i class="fas fa-user"></i> –í—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞</h4>
                    <div class="form-group">
                        <select id="voice-select" class="form-control">
                            <option value="">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä</option>
                        </select>
                        <div style="font-size: 0.9rem; color: #666; margin-top: 5px;">
                            –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π –≥–æ–ª–æ—Å –¥–ª—è –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è —è–ø–æ–Ω—Å–∫–∏—Ö —Å–ª–æ–≤
                        </div>
                    </div>
                </div>
                
                <div class="settings-group">
                    <h4><i class="fas fa-cogs"></i> –†–µ–∂–∏–º—ã –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è</h4>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="speak-question" checked>
                            <label for="speak-question">–û–∑–≤—É—á–∏–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="speak-correct-answer" checked>
                            <label for="speak-correct-answer">–û–∑–≤—É—á–∏–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (–¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ)</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="speak-all-options">
                            <label for="speak-all-options">–û–∑–≤—É—á–∏–≤–∞—Ç—å –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="speak-only-on-button">
                            <label for="speak-only-on-button">–û–∑–≤—É—á–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ –∫–Ω–æ–ø–∫–µ (–æ—Ç–∫–ª—é—á–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ)</label>
                        </div>
                    </div>
                </div>
                
                <div class="settings-group">
                    <h4><i class="fas fa-microphone-alt"></i> –¢–µ—Å—Ç –æ–∑–≤—É—á–∫–∏</h4>
                    <div class="form-group">
                        <label for="test-speech-text">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏:</label>
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <input type="text" id="test-speech-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —è–ø–æ–Ω—Å–∫–∏–π —Ç–µ–∫—Å—Ç" style="flex: 1;" value="„Åì„Çì„Å´„Å°„ÅØ">
                            <button class="btn btn-accent" id="btn-test-speech">
                                <i class="fas fa-volume-up"></i> –ü—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏
                            </button>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                            <p>–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∞: „Åì„Çì„Å´„Å°„ÅØ (–ø—Ä–∏–≤–µ—Ç), „ÅÇ„Çä„Åå„Å®„ÅÜ (—Å–ø–∞—Å–∏–±–æ), „Åï„Çà„ÅÜ„Å™„Çâ (–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è)</p>
                            <p id="speech-status" style="color: var(--accent);"></p>
                        </div>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button class="btn btn-secondary" id="btn-reset-speech-settings">
                        <i class="fas fa-undo"></i> –°–±—Ä–æ—Å–∏—Ç—å –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º
                    </button>
                </div>
                
                <div id="speech-settings-feedback" class="feedback hidden" style="margin-top: 15px;"></div>
            </div>

            <div class="instructions">
                <h3><i class="fas fa-layer-group"></i> –°–∏—Å—Ç–µ–º–∞ –∫–∞—Ä—Ç–æ—á–µ–∫:</h3>
                <ul>
                    <li>–ö–∞—Ä—Ç–æ—á–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ 10 —Å–ª–æ–≤</li>
                    <li>–°–ª–æ–≤–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º</li>
                    <li>–ö–∞—Ä—Ç–æ—á–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑—É—á–µ–Ω–Ω–æ–π, –∫–æ–≥–¥–∞ –≤—Å–µ —Å–ª–æ–≤–∞ –≤—ã—É—á–µ–Ω—ã –∏–¥–µ–∞–ª—å–Ω–æ</li>
                    <li>–í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç</li>
                </ul>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" id="btn-generate-decks">
                    <i class="fas fa-plus-square"></i> –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏
                </button>
                <button class="btn btn-warning" id="btn-shuffle-decks">
                    <i class="fas fa-random"></i> –ü–µ—Ä–µ–º–µ—à–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏
                </button>
            </div>

            <div id="decks-list" class="deck-list"></div>

            <hr style="margin: 40px 0; border: 0; border-top: 1px solid #eee;">

            <div id="cards-list-container">
                <div id="cards-list" class="card-list"></div>
                <div id="empty-cards" class="empty-state hidden">
                    <div class="empty-state-icon">üóÇÔ∏è</div>
                    <p>–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫</p>
                    <p>–î–æ–±–∞–≤—å—Ç–µ —Å–ª–æ–≤–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ "–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–∞"</p>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-danger" id="btn-clear-all">
                    <i class="fas fa-trash-alt"></i> –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏
                </button>
                <button class="btn btn-secondary" id="btn-export">
                    <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ CSV
                </button>
            </div>

            <div id="manage-feedback" class="feedback hidden"></div>
        </div>
    </div>

    <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="mobile-nav">
        <div class="mobile-nav-tabs">
            <a href="#" class="mobile-tab active" data-tab="dashboard">
                <i class="fas fa-home"></i>
                <span>–ì–ª–∞–≤–Ω–∞—è</span>
            </a>
            <a href="#" class="mobile-tab" data-tab="add">
                <i class="fas fa-plus-circle"></i>
                <span>–î–æ–±–∞–≤–∏—Ç—å</span>
            </a>
            <a href="#" class="mobile-tab" data-tab="study">
                <i class="fas fa-graduation-cap"></i>
                <span>–û–±—É—á–µ–Ω–∏–µ</span>
            </a>
            <a href="#" class="mobile-tab" data-tab="manage">
                <i class="fas fa-cog"></i>
                <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</span>
            </a>
        </div>
    </nav>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-text">
                <p>
                    <a href="https://github.com/Marveee3/Japanese-Vocabulary-Trainer/tree/main" 
                    style="color: inherit; text-decoration: none;">
                        marveee3 - 2025
                    </a>
                </p>
            </div>
            <div class="footer-stats">
                <p>–ö–∞—Ä—Ç–æ—á–µ–∫: <span id="footer-total-cards">0</span></p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // –ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
        class VocabularyApp {
            constructor() {
                this.cards = JSON.parse(localStorage.getItem('jp-vocab-cards')) || [];
                this.decks = JSON.parse(localStorage.getItem('jp-vocab-decks')) || [];
                this.todayCount = parseInt(localStorage.getItem('today-count')) || 0;
                this.lastStudyDate = localStorage.getItem('last-study-date') || '';
                this.currentMode = null;
                this.currentDeck = null;
                this.currentCard = null;
                this.studySession = [];
                this.sessionProgress = 0;
                this.fileData = null;
                
                this.deckStats = JSON.parse(localStorage.getItem('deck-stats')) || {};
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                this.speechSettings = JSON.parse(localStorage.getItem('jp-vocab-speech-settings')) || {
                    rate: 1.0,
                    selectedVoice: '',
                    speakQuestion: true,
                    speakCorrectAnswer: true,
                    speakAllOptions: false,
                    speakOnlyOnButton: false
                };
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏
                this.speechSupported = 'speechSynthesis' in window;
                this.japaneseVoicesAvailable = false;
                this.availableVoices = [];
                this.selectedVoice = null;
                this.speechInitialized = false;
                
                this.initializeEventListeners();
                this.updateDashboard();
                this.checkDailyReset();
                this.loadSpeechSettings();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥–æ–ª–æ—Å–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                this.loadVoices();
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
                if (this.cards.length > 0 && this.decks.length === 0) {
                    this.generateDecks();
                }
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤
            loadVoices() {
                if (!this.speechSupported) {
                    console.warn('–°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º');
                    this.showSpeechStatus('–°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º');
                    return;
                }
                
                // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≥–æ–ª–æ—Å–æ–≤
                const getVoices = () => {
                    this.availableVoices = speechSynthesis.getVoices();
                    
                    if (this.availableVoices.length > 0) {
                        console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ–ª–æ—Å–∞:', this.availableVoices);
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —è–ø–æ–Ω—Å–∫–∏—Ö –≥–æ–ª–æ—Å–æ–≤
                        this.japaneseVoicesAvailable = this.availableVoices.some(voice => 
                            voice.lang === 'ja-JP' || voice.lang.startsWith('ja')
                        );
                        
                        if (this.japaneseVoicesAvailable) {
                            this.showSpeechStatus('–Ø–ø–æ–Ω—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞ –¥–æ—Å—Ç—É–ø–Ω—ã');
                        } else {
                            this.showSpeechStatus('–Ø–ø–æ–Ω—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –≥–æ–ª–æ—Å.');
                        }
                        
                        // –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –≥–æ–ª–æ—Å–æ–≤ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
                        this.populateVoiceList();
                        
                        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–ª–æ—Å
                        this.restoreSelectedVoice();
                        
                        // –ü–æ–º–µ—á–∞–µ–º, —á—Ç–æ –≥–æ–ª–æ—Å–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
                        this.speechInitialized = true;
                    } else {
                        console.warn('–ì–æ–ª–æ—Å–∞ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                        this.showSpeechStatus('–ì–æ–ª–æ—Å–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è...');
                    }
                };
                
                // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –≥–æ–ª–æ—Å–∞ —Å—Ä–∞–∑—É
                getVoices();
                
                // –ï—Å–ª–∏ –≥–æ–ª–æ—Å–∞ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∂–¥–µ–º —Å–æ–±—ã—Ç–∏—è
                if (this.availableVoices.length === 0) {
                    speechSynthesis.onvoiceschanged = getVoices;
                }
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –æ–∑–≤—É—á–∫–∏
            showSpeechStatus(message) {
                const statusElement = document.getElementById('speech-status');
                if (statusElement) {
                    statusElement.textContent = message;
                }
            }

            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≥–æ–ª–æ—Å–æ–≤
            populateVoiceList() {
                const voiceSelect = document.getElementById('voice-select');
                const voiceContainer = document.getElementById('voice-selection-container');
                
                if (!voiceSelect || !voiceContainer) return;
                
                // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
                voiceSelect.innerHTML = '<option value="">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä</option>';
                
                if (this.availableVoices.length === 0) {
                    voiceContainer.style.display = 'none';
                    return;
                }
                
                // –§–∏–ª—å—Ç—Ä—É–µ–º —è–ø–æ–Ω—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞
                const japaneseVoices = this.availableVoices.filter(voice => 
                    voice.lang === 'ja-JP' || voice.lang.startsWith('ja')
                );
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å —è–ø–æ–Ω—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
                if (japaneseVoices.length > 0) {
                    voiceContainer.style.display = 'block';
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —è–ø–æ–Ω—Å–∫–∏–µ –≥–æ–ª–æ—Å–∞
                    japaneseVoices.forEach((voice, index) => {
                        const option = document.createElement('option');
                        option.value = voice.voiceURI;
                        option.textContent = `${voice.name} (${voice.lang})`;
                        voiceSelect.appendChild(option);
                    });
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≥–æ–ª–æ—Å–∞
                    const otherVoices = this.availableVoices.filter(voice => 
                        !voice.lang.startsWith('ja')
                    );
                    
                    if (otherVoices.length > 0) {
                        const optgroup = document.createElement('optgroup');
                        optgroup.label = '–î—Ä—É–≥–∏–µ –≥–æ–ª–æ—Å–∞';
                        otherVoices.forEach(voice => {
                            const option = document.createElement('option');
                            option.value = voice.voiceURI;
                            option.textContent = `${voice.name} (${voice.lang})`;
                            optgroup.appendChild(option);
                        });
                        voiceSelect.appendChild(optgroup);
                    }
                } else {
                    voiceContainer.style.display = 'block';
                    
                    // –ï—Å–ª–∏ –Ω–µ—Ç —è–ø–æ–Ω—Å–∫–∏—Ö –≥–æ–ª–æ—Å–æ–≤, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ
                    this.availableVoices.forEach((voice, index) => {
                        const option = document.createElement('option');
                        option.value = voice.voiceURI;
                        option.textContent = `${voice.name} (${voice.lang})`;
                        voiceSelect.appendChild(option);
                    });
                }
            }

            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–æ–ª–æ—Å–∞
            restoreSelectedVoice() {
                if (!this.speechSettings.selectedVoice) return;
                
                const voiceSelect = document.getElementById('voice-select');
                if (!voiceSelect) return;
                
                // –ò—â–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–ª–æ—Å –≤ —Å–ø–∏—Å–∫–µ
                for (let i = 0; i < voiceSelect.options.length; i++) {
                    if (voiceSelect.options[i].value === this.speechSettings.selectedVoice) {
                        voiceSelect.selectedIndex = i;
                        this.selectedVoice = this.availableVoices.find(v => v.voiceURI === this.speechSettings.selectedVoice);
                        break;
                    }
                }
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–∑–≤—É—á–∫–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            loadSpeechSettings() {
                document.getElementById('speech-rate').value = this.speechSettings.rate;
                document.getElementById('rate-value').textContent = this.speechSettings.rate;
                
                document.getElementById('speak-question').checked = this.speechSettings.speakQuestion;
                document.getElementById('speak-correct-answer').checked = this.speechSettings.speakCorrectAnswer;
                document.getElementById('speak-all-options').checked = this.speechSettings.speakAllOptions;
                document.getElementById('speak-only-on-button').checked = this.speechSettings.speakOnlyOnButton;
            }

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–∑–≤—É—á–∫–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏)
            saveSpeechSettings() {
                this.speechSettings = {
                    rate: parseFloat(document.getElementById('speech-rate').value),
                    selectedVoice: document.getElementById('voice-select').value,
                    speakQuestion: document.getElementById('speak-question').checked,
                    speakCorrectAnswer: document.getElementById('speak-correct-answer').checked,
                    speakAllOptions: document.getElementById('speak-all-options').checked,
                    speakOnlyOnButton: document.getElementById('speak-only-on-button').checked
                };
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–ª–æ—Å
                if (this.speechSettings.selectedVoice) {
                    this.selectedVoice = this.availableVoices.find(v => v.voiceURI === this.speechSettings.selectedVoice);
                } else {
                    this.selectedVoice = null;
                }
                
                localStorage.setItem('jp-vocab-speech-settings', JSON.stringify(this.speechSettings));
                return this.speechSettings;
            }

            // –°–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –æ–∑–≤—É—á–∫–∏ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º
            resetSpeechSettings() {
                this.speechSettings = {
                    rate: 1.0,
                    selectedVoice: '',
                    speakQuestion: true,
                    speakCorrectAnswer: true,
                    speakAllOptions: false,
                    speakOnlyOnButton: false
                };
                
                localStorage.setItem('jp-vocab-speech-settings', JSON.stringify(this.speechSettings));
                this.loadSpeechSettings();
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –≥–æ–ª–æ—Å–∞
                const voiceSelect = document.getElementById('voice-select');
                if (voiceSelect) {
                    voiceSelect.value = '';
                }
                this.selectedVoice = null;
                
                return this.speechSettings;
            }

            // –û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ —è–ø–æ–Ω—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
            speakJapanese(text) {
                if (!this.speechSupported) {
                    console.warn('–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏');
                    this.showSpeechStatus('–°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                    return false;
                }
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ
                speechSynthesis.cancel();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ª–∏ –≥–æ–ª–æ—Å–∞
                if (!this.speechInitialized) {
                    console.warn('–ì–æ–ª–æ—Å–∞ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                    this.showSpeechStatus('–ì–æ–ª–æ—Å–∞ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...');
                    return false;
                }
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ja-JP';
                utterance.rate = this.speechSettings.rate;
                utterance.pitch = 1.0;
                utterance.volume = 1.0;
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–ª–æ—Å, –µ—Å–ª–∏ –æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω
                if (this.selectedVoice) {
                    utterance.voice = this.selectedVoice;
                } else {
                    // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —è–ø–æ–Ω—Å–∫–∏–π –≥–æ–ª–æ—Å
                    const voices = speechSynthesis.getVoices();
                    let japaneseVoice = voices.find(voice => 
                        voice.lang === 'ja-JP' || voice.lang.startsWith('ja')
                    );
                    
                    if (!japaneseVoice && voices.length > 0) {
                        // –ï—Å–ª–∏ —è–ø–æ–Ω—Å–∫–∏–π –≥–æ–ª–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π
                        japaneseVoice = voices[0];
                        console.log('–Ø–ø–æ–Ω—Å–∫–∏–π –≥–æ–ª–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é:', japaneseVoice.name);
                    }
                    
                    if (japaneseVoice) {
                        utterance.voice = japaneseVoice;
                    }
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                utterance.onstart = () => {
                    console.log('–ù–∞—á–∞–ª–æ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è:', text);
                    this.showSpeechStatus('–û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ...');
                };
                
                utterance.onend = () => {
                    console.log('–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è');
                    this.showSpeechStatus('–ì–æ—Ç–æ–≤–æ');
                    const speakingButtons = document.querySelectorAll('.speak-btn.speaking');
                    speakingButtons.forEach(btn => {
                        btn.classList.remove('speaking');
                        btn.innerHTML = '<i class="fas fa-volume-up"></i>';
                    });
                };
                
                utterance.onerror = (event) => {
                    console.error('–û—à–∏–±–∫–∞ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è:', event.error);
                    this.showSpeechStatus('–û—à–∏–±–∫–∞ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è');
                    const speakingButtons = document.querySelectorAll('.speak-btn.speaking');
                    speakingButtons.forEach(btn => {
                        btn.classList.remove('speaking');
                        btn.innerHTML = '<i class="fas fa-volume-up"></i>';
                    });
                };
                
                // –ü—Ä–æ–∏–∑–Ω–æ—Å–∏–º —Ç–µ–∫—Å—Ç
                try {
                    speechSynthesis.speak(utterance);
                    return true;
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ speechSynthesis.speak:', error);
                    this.showSpeechStatus('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–∏');
                    return false;
                }
            }

            // –û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ–∂–∏–º–æ–º (—É—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
            speakJapaneseAuto(text, context = 'question') {
                // –ï—Å–ª–∏ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–æ –∫–Ω–æ–ø–∫–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ
                if (this.speechSettings.speakOnlyOnButton) {
                    return false;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
                if (context === 'question' && !this.speechSettings.speakQuestion) {
                    return false;
                }
                
                if (context === 'correct-answer' && !this.speechSettings.speakCorrectAnswer) {
                    return false;
                }
                
                return this.speakJapanese(text);
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            initializeEventListeners() {
                // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ (–¥–µ—Å–∫—Ç–æ–ø)
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.switchTab(e.target.dataset.tab);
                    });
                });

                // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ (–º–æ–±–∏–ª—å–Ω—ã–µ)
                document.querySelectorAll('.mobile-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.switchTab(e.target.closest('.mobile-tab').dataset.tab);
                    });
                });

                // –ö–Ω–æ–ø–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
                document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                    const desktopTabs = document.getElementById('desktop-tabs');
                    desktopTabs.style.display = desktopTabs.style.display === 'flex' ? 'none' : 'flex';
                });

                // –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                document.getElementById('btn-add-words').addEventListener('click', () => this.switchTab('add'));
                document.getElementById('btn-start-study').addEventListener('click', () => this.switchTab('study'));
                
                // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é
                document.getElementById('btn-add-manual').addEventListener('click', () => this.addManualCard());
                
                // –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Minna no Nihongo
                document.getElementById('btn-load-minna').addEventListener('click', () => this.loadMinnaNoNihongo());
                
                // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
                const uploadArea = document.getElementById('upload-area');
                const fileInput = document.getElementById('file-input');
                
                uploadArea.addEventListener('click', () => fileInput.click());
                uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadArea.style.borderColor = 'var(--accent)';
                    uploadArea.style.background = 'rgba(52, 152, 219, 0.05)';
                });
                uploadArea.addEventListener('dragleave', () => {
                    uploadArea.style.borderColor = '#ddd';
                    uploadArea.style.background = 'white';
                });
                uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadArea.style.borderColor = '#ddd';
                    uploadArea.style.background = 'white';
                    this.handleFileUpload(e.dataTransfer.files[0]);
                });
                
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        this.handleFileUpload(e.target.files[0]);
                    }
                });

                document.getElementById('btn-import-file').addEventListener('click', () => this.importFileData());
                
                // –†–µ–∂–∏–º—ã –æ–±—É—á–µ–Ω–∏—è
                document.querySelectorAll('[data-mode]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.startStudyMode(e.target.dataset.mode);
                    });
                });

                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏–µ–º
                document.getElementById('btn-check-answer').addEventListener('click', () => this.checkAnswer());
                document.getElementById('btn-show-answer').addEventListener('click', () => this.showAnswer());
                document.getElementById('btn-skip').addEventListener('click', () => this.nextCard());
                document.getElementById('btn-back-to-modes').addEventListener('click', () => this.backToModes());
                document.getElementById('btn-stop-study').addEventListener('click', () => this.stopStudy());
                
                // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
                document.getElementById('btn-clear-all').addEventListener('click', () => this.clearAllCards());
                document.getElementById('btn-export').addEventListener('click', () => this.exportCards());
                document.getElementById('btn-generate-decks').addEventListener('click', () => this.generateDecks());
                document.getElementById('btn-shuffle-decks').addEventListener('click', () => this.shuffleDecks());
                document.getElementById('btn-change-deck').addEventListener('click', () => this.changeDeck());
                document.getElementById('btn-stop-deck').addEventListener('click', () => this.stopDeck());
                
                // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞ –≤ —Ä–µ–∂–∏–º–µ –æ–±—É—á–µ–Ω–∏—è
                document.getElementById('study-input').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.checkAnswer();
                });
                
                // –ö–Ω–æ–ø–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
                document.getElementById('btn-continue').addEventListener('click', () => this.continueAfterMistake());
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
                document.getElementById('speech-rate').addEventListener('input', (e) => {
                    document.getElementById('rate-value').textContent = e.target.value;
                    this.saveSpeechSettings();
                    this.showFeedback('speech-settings-feedback', '–°–∫–æ—Ä–æ—Å—Ç—å –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞', 'correct', 2000);
                });
                
                document.getElementById('voice-select').addEventListener('change', () => {
                    this.saveSpeechSettings();
                    this.showFeedback('speech-settings-feedback', '–ì–æ–ª–æ—Å –∏–∑–º–µ–Ω–µ–Ω', 'correct', 2000);
                });
                
                // –ß–µ–∫–±–æ–∫—Å—ã - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
                document.getElementById('speak-question').addEventListener('change', () => {
                    this.saveSpeechSettings();
                    this.showFeedback('speech-settings-feedback', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'correct', 2000);
                });
                
                document.getElementById('speak-correct-answer').addEventListener('change', () => {
                    this.saveSpeechSettings();
                    this.showFeedback('speech-settings-feedback', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'correct', 2000);
                });
                
                document.getElementById('speak-all-options').addEventListener('change', () => {
                    this.saveSpeechSettings();
                    this.showFeedback('speech-settings-feedback', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'correct', 2000);
                });
                
                document.getElementById('speak-only-on-button').addEventListener('change', () => {
                    this.saveSpeechSettings();
                    this.showFeedback('speech-settings-feedback', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'correct', 2000);
                });
                
                document.getElementById('btn-reset-speech-settings').addEventListener('click', () => {
                    if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º?')) {
                        this.resetSpeechSettings();
                        this.showFeedback('speech-settings-feedback', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∑–≤—É—á–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã', 'correct');
                    }
                });
                
                document.getElementById('btn-test-speech').addEventListener('click', () => {
                    const text = document.getElementById('test-speech-text').value.trim();
                    if (text) {
                        this.showSpeechStatus('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∑–≤—É—á–∫–∏...');
                        const success = this.speakJapanese(text);
                        if (!success) {
                            this.showSpeechStatus('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ–∑–≤—É—á–∫–∏');
                        }
                    } else {
                        alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —Ç–µ—Å—Ç–∞ –æ–∑–≤—É—á–∫–∏');
                    }
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —Ñ—É—Ç–µ—Ä–µ
                this.updateFooterStats();
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –≥–æ—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Å–ª–æ–≤ –∏–∑ Minna no Nihongo
            async loadMinnaNoNihongo() {
                const statusElement = document.getElementById('minna-load-status');
                const btn = document.getElementById('btn-load-minna');
                const originalText = btn.innerHTML;
                
                try {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
                    statusElement.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞–±–æ—Ä–∞ —Å–ª–æ–≤ Minna no Nihongo...';
                    statusElement.className = 'feedback correct';
                    statusElement.classList.remove('hidden');
                    
                    btn.disabled = true;
                    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞...';
                    
                    // URL –∫ —Ñ–∞–π–ª—É Minna no Nihongo (—Å—ã—Ä–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ GitHub)
                    const url = 'https://raw.githubusercontent.com/Marveee3/Japanese-Vocabulary-Trainer/main/Minna%20no%20Nihongo.%20%D0%93%D1%80%D0%B0%D0%BC%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B8%CC%86%20%D0%BA%D0%BE%D0%BC%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%80%D0%B8%D0%B8%CC%86%20-%201.txt';
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª
                    const response = await fetch(url);
                    
                    if (!response.ok) {
                        throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${response.status} ${response.statusText}`);
                    }
                    
                    const text = await response.text();
                    
                    // –ü–∞—Ä—Å–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
                    const lines = text.split('\n')
                        .map(line => line.trim())
                        .filter(line => line.length > 0);
                    
                    if (lines.length === 0) {
                        throw new Error('–§–∞–π–ª –ø—É—Å—Ç–æ–π –∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç');
                    }
                    
                    let addedCount = 0;
                    let skippedCount = 0;
                    
                    // –ü–∞—Ä—Å–∏–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º —Ñ–æ—Ä–º–∞—Ç: —è–ø–æ–Ω—Å–∫–æ–µ —Å–ª–æ–≤–æ - –ø–µ—Ä–µ–≤–æ–¥)
                    lines.forEach(line => {
                        // –ü—ã—Ç–∞–µ–º—Å—è —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ —Ä–∞–∑–Ω—ã–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º
                        let parts = [];
                        
                        // –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
                        if (line.includes(' - ')) {
                            parts = line.split(' - ').map(part => part.trim());
                        } else if (line.includes(' ‚Äî ')) {
                            parts = line.split(' ‚Äî ').map(part => part.trim());
                        } else if (line.includes('\t')) {
                            parts = line.split('\t').map(part => part.trim());
                        } else if (line.includes(',')) {
                            parts = line.split(',').map(part => part.trim());
                        } else {
                            // –ï—Å–ª–∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫—É
                            skippedCount++;
                            return;
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã 2 —á–∞—Å—Ç–∏
                        if (parts.length >= 2) {
                            const japanese = parts[0].trim();
                            let russian = parts[1].trim();
                            
                            // –£–±–∏—Ä–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–∫–æ–±–∫–∏ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
                            russian = russian.replace(/\(.*?\)/g, '').trim();
                            
                            // –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –∑–∞–ø—è—Ç—ã–µ
                            russian = russian.replace(/\s+/g, ' ').replace(/,$/, '');
                            
                            if (japanese && russian) {
                                // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ä—Ç–æ—á–∫—É
                                this.addCard(japanese, russian);
                                addedCount++;
                            } else {
                                skippedCount++;
                            }
                        } else {
                            skippedCount++;
                        }
                    });
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    let message = `–£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ ${addedCount} —Å–ª–æ–≤ –∏–∑ Minna no Nihongo`;
                    if (skippedCount > 0) {
                        message += ` (–ø—Ä–æ–ø—É—â–µ–Ω–æ ${skippedCount} —Å—Ç—Ä–æ–∫ –∏–∑-–∑–∞ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞)`;
                    }
                    
                    statusElement.textContent = message;
                    statusElement.className = 'feedback correct';
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    this.updateDashboard();
                    this.showFeedback('add-feedback', `–î–æ–±–∞–≤–ª–µ–Ω –Ω–∞–±–æ—Ä Minna no Nihongo: ${addedCount} —Å–ª–æ–≤`, 'correct');
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Minna no Nihongo:', error);
                    statusElement.textContent = `–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`;
                    statusElement.className = 'feedback incorrect';
                } finally {
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                    btn.disabled = false;
                    btn.innerHTML = originalText;
                    
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    setTimeout(() => {
                        statusElement.classList.add('hidden');
                    }, 5000);
                }
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Å–±—Ä–æ—Å –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞
            checkDailyReset() {
                const today = new Date().toDateString();
                if (this.lastStudyDate !== today) {
                    this.todayCount = 0;
                    this.lastStudyDate = today;
                    localStorage.setItem('today-count', '0');
                    localStorage.setItem('last-study-date', today);
                }
            }

            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
            switchTab(tabId) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.dataset.tab === tabId) {
                        tab.classList.add('active');
                    }
                });

                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
                document.querySelectorAll('.mobile-tab').forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.dataset.tab === tabId) {
                        tab.classList.add('active');
                    }
                });

                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tabId).classList.add('active');

                // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –≤–∫–ª–∞–¥–∫–∏
                if (window.innerWidth <= 768) {
                    document.getElementById('desktop-tabs').style.display = 'none';
                }

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É
                this.currentTab = tabId;

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
                if (tabId === 'manage') {
                    this.renderDecksList();
                    this.renderCardsList();
                }
                
                if (tabId === 'dashboard') {
                    this.updateDashboard();
                }
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
            updateDashboard() {
                document.getElementById('total-cards').textContent = this.cards.length;
                
                const progress = this.cards.length > 0 ? 
                    Math.round((this.todayCount / this.cards.length) * 100) : 0;
                document.getElementById('study-progress').textContent = `${progress}%`;
                document.getElementById('today-count').textContent = this.todayCount;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —Ñ—É—Ç–µ—Ä–µ
                this.updateFooterStats();
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ —Ñ—É—Ç–µ—Ä–µ
            updateFooterStats() {
                document.getElementById('footer-total-cards').textContent = this.cards.length;
            }

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤—Ä—É—á–Ω—É—é
            addManualCard() {
                const japanese = document.getElementById('manual-japanese').value.trim();
                const russian = document.getElementById('manual-russian').value.trim();

                if (!japanese || !russian) {
                    this.showFeedback('add-feedback', '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±–∞ –ø–æ–ª—è', 'incorrect');
                    return;
                }

                this.addCard(japanese, russian);
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª—è
                document.getElementById('manual-japanese').value = '';
                document.getElementById('manual-russian').value = '';
                
                this.showFeedback('add-feedback', `–ö–∞—Ä—Ç–æ—á–∫–∞ "${japanese} - ${russian}" –¥–æ–±–∞–≤–ª–µ–Ω–∞!`, 'correct');
            }

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
            addCard(japanese, russian) {
                const card = {
                    id: Date.now() + Math.random(),
                    japanese: japanese,
                    russian: russian,
                    createdAt: new Date().toISOString()
                };
                
                this.cards.push(card);
                this.saveCards();
                
                // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤
                if (this.cards.length % 10 === 0 || this.decks.length === 0) {
                    this.generateDecks();
                }
            }

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ localStorage
            saveCards() {
                localStorage.setItem('jp-vocab-cards', JSON.stringify(this.cards));
                this.updateDashboard();
                this.updateFooterStats();
            }

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
            handleFileUpload(file) {
                if (!file) return;
                
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    const content = e.target.result;
                    this.previewFile(content);
                };
                
                reader.readAsText(file);
            }

            // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–∞
            previewFile(content) {
                const lines = content.split('\n')
                    .map(line => line.trim())
                    .filter(line => line.length > 0);
                
                if (lines.length === 0) {
                    this.showFeedback('add-feedback', '–§–∞–π–ª –ø—É—Å—Ç–æ–π', 'incorrect');
                    return;
                }

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
                const previewLines = lines.slice(0, 5);
                const previewContent = previewLines.map((line, idx) => {
                    return `–°—Ç—Ä–æ–∫–∞ ${idx + 1}: ${line}`;
                }).join('\n');
                
                document.getElementById('preview-content').textContent = previewContent;
                document.getElementById('file-preview').classList.remove('hidden');
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
                this.fileData = lines;
            }

            // –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞
            importFileData() {
                if (!this.fileData || this.fileData.length === 0) {
                    this.showFeedback('add-feedback', '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞', 'incorrect');
                    return;
                }

                let addedCount = 0;
                let errorsCount = 0;

                this.fileData.forEach(line => {
                    const parts = line.split(',').map(part => part.trim());
                    
                    if (parts.length >= 2 && parts[0] && parts[1]) {
                        this.addCard(parts[0], parts[1]);
                        addedCount++;
                    } else {
                        errorsCount++;
                    }
                });

                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞
                this.fileData = null;
                document.getElementById('file-preview').classList.add('hidden');
                document.getElementById('file-input').value = '';

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                let message = `–£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ: ${addedCount}`;
                if (errorsCount > 0) {
                    message += `, –æ—à–∏–±–æ–∫: ${errorsCount}`;
                }
                this.showFeedback('add-feedback', message, errorsCount === 0 ? 'correct' : 'warning');
            }

            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–æ 10 —Å–ª–æ–≤
            generateDecks() {
                if (this.cards.length === 0) {
                    alert('–ù–µ—Ç —Å–ª–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫.');
                    return;
                }

                // –°–º–µ—à–∏–≤–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
                const shuffledCards = [...this.cards];
                this.shuffleArray(shuffledCards);
                
                this.decks = [];
                
                // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–æ 10 —Å–ª–æ–≤ (–∏–ª–∏ –º–µ–Ω—å—à–µ –µ—Å–ª–∏ —Å–ª–æ–≤ –º–µ–Ω—å—à–µ 10)
                const deckSize = 10;
                for (let i = 0; i < shuffledCards.length; i += deckSize) {
                    const deckCards = shuffledCards.slice(i, i + deckSize);
                    const deckId = 'deck-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                    
                    this.decks.push({
                        id: deckId,
                        name: `–ö–∞—Ä—Ç–æ—á–∫–∞ ${Math.floor(i/deckSize) + 1}`,
                        cards: deckCards,
                        completed: false,
                        stats: {
                            learned: 0,
                            errors: 0,
                            currentStreak: 0,
                            lastStudy: null
                        }
                    });
                }
                
                this.saveDecks();
                this.updateDashboard();
                
                if (this.currentTab === 'manage') {
                    this.renderDecksList();
                }
                
                this.showFeedback('manage-feedback', `–°–æ–∑–¥–∞–Ω–æ ${this.decks.length} –∫–∞—Ä—Ç–æ—á–µ–∫`, 'correct');
            }

            // –ü–µ—Ä–µ–º–µ—à–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏
            shuffleDecks() {
                if (this.cards.length < 10) {
                    alert('–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 10 —Å–ª–æ–≤.');
                    return;
                }

                if (confirm('–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏? –≠—Ç–æ —Å–±—Ä–æ—Å–∏—Ç –≤—Å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.')) {
                    this.decks = [];
                    this.deckStats = {};
                    this.generateDecks();
                    localStorage.removeItem('deck-stats');
                }
            }

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
            saveDecks() {
                localStorage.setItem('jp-vocab-decks', JSON.stringify(this.decks));
                localStorage.setItem('deck-stats', JSON.stringify(this.deckStats));
            }

            // –ù–∞—á–∞–ª–æ —Ä–µ–∂–∏–º–∞ –æ–±—É—á–µ–Ω–∏—è
            startStudyMode(mode) {
                if (this.cards.length < 4) {
                    alert('–î–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 4 –∫–∞—Ä—Ç–æ—á–∫–∏. –î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ —Å–ª–æ–≤.');
                    return;
                }

                if (this.decks.length === 0) {
                    this.generateDecks();
                }

                this.currentMode = mode;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫
                document.getElementById('study-selection').classList.add('hidden');
                document.getElementById('deck-selection').classList.remove('hidden');
                document.getElementById('study-area').classList.add('hidden');
                
                this.renderDeckSelection();
            }

            // –†–µ–Ω–¥–µ—Ä –≤—ã–±–æ—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
            renderDeckSelection() {
                const container = document.getElementById('deck-list');
                container.innerHTML = '';
                
                if (this.decks.length === 0) {
                    container.innerHTML = '<div class="empty-state"><p>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫. –°–æ–∑–¥–∞–π—Ç–µ –∏—Ö –≤ —Ä–∞–∑–¥–µ–ª–µ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏".</p></div>';
                    return;
                }

                this.decks.forEach((deck, index) => {
                    const card = document.createElement('div');
                    card.className = 'deck-card';
                    card.setAttribute('data-id', deck.id);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É –∞–∫—Ç–∏–≤–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
                    if (this.currentDeck && deck.id === this.currentDeck.id) {
                        card.classList.add('active');
                    }
                    if (deck.completed) {
                        card.classList.add('completed');
                    }
                    
                    const progress = deck.cards.length > 0 ? 
                        Math.round((deck.stats.learned / deck.cards.length) * 100) : 0;
                    
                    card.innerHTML = `
                        <h4>${deck.name}</h4>
                        <div>–°–ª–æ–≤: ${deck.cards.length}</div>
                        <div>–ò–∑—É—á–µ–Ω–æ: ${deck.stats.learned || 0}</div>
                        <div>–û—à–∏–±–æ–∫: ${deck.stats.errors || 0}</div>
                        <div class="progress">
                            <div class="fill" style="width: ${progress}%"></div>
                        </div>
                        <div style="font-size: 0.9rem; color: #666; margin-top: 5px;">
                            ${deck.completed ? '‚úì –ó–∞–≤–µ—Ä—à–µ–Ω–∞' : '–í –ø—Ä–æ—Ü–µ—Å—Å–µ'}
                            <span style="margin-left: 10px; font-size: 0.8rem; color: #999;">(–∫–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞)</span>
                        </div>
                    `;
                    
                    card.addEventListener('click', () => {
                        this.selectDeck(deck);
                    });
                    
                    container.appendChild(card);
                });
            }

            // –í—ã–±–æ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏
            selectDeck(deck) {
                if (!deck || !deck.cards || deck.cards.length === 0) {
                    alert('–≠—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—É—Å—Ç–∞ –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞');
                    return;
                }
                
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
                document.querySelectorAll('.deck-card').forEach(card => {
                    card.classList.remove('active');
                });
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –∞–∫—Ç–∏–≤–Ω–æ–π –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–µ
                const selectedCard = document.querySelector(`.deck-card[data-id="${deck.id}"]`);
                if (selectedCard) {
                    selectedCard.classList.add('active');
                }
                
                this.currentDeck = deck;
                this.studySession = [...deck.cards];
                this.shuffleArray(this.studySession);
                this.sessionProgress = 0;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                this.updateDeckInfo();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±–ª–∞—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
                document.getElementById('deck-selection').classList.add('hidden');
                document.getElementById('study-area').classList.remove('hidden');
                document.getElementById('deck-info').classList.remove('hidden');
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
                this.setupStudyInterface();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É
                this.nextCard();
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—Ä—Ç–æ—á–∫–µ
            updateDeckInfo() {
                document.getElementById('deck-title').textContent = `–¢–µ–∫—É—â–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞: ${this.currentDeck.name}`;
                document.getElementById('deck-total').textContent = this.currentDeck.cards.length;
                document.getElementById('deck-errors').textContent = this.currentDeck.stats.errors;
                document.getElementById('deck-current-streak').textContent = this.currentDeck.stats.currentStreak;
                
                const learnedCount = this.currentDeck.stats.learned;
                document.getElementById('deck-progress').textContent = `${learnedCount}/${this.currentDeck.cards.length}`;
                
                const streakText = this.currentDeck.stats.currentStreak > 0 ? 
                    `–¢–µ–∫—É—â–∞—è —Å–µ—Ä–∏—è: ${this.currentDeck.stats.currentStreak}` : '';
                document.getElementById('deck-streak').textContent = streakText;
                document.getElementById('deck-streak').style.display = streakText ? 'inline' : 'none';
            }

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–∂–∏–º–∞
            setupStudyInterface() {
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
                const continueGroup = document.getElementById('continue-group');
                if (continueGroup) {
                    continueGroup.style.display = 'none';
                }
                
                const inputArea = document.getElementById('input-area');
                const optionsArea = document.getElementById('options-area');
                const checkBtn = document.getElementById('btn-check-answer');
                const showBtn = document.getElementById('btn-show-answer');
                const skipBtn = document.getElementById('btn-skip');
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                inputArea.classList.add('hidden');
                optionsArea.classList.add('hidden');
                optionsArea.innerHTML = '';
                document.getElementById('study-input').value = '';
                document.getElementById('study-feedback').classList.add('hidden');
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
                if (this.currentMode === 'input-jp' || this.currentMode === 'input-ru') {
                    inputArea.classList.remove('hidden');
                    checkBtn.classList.remove('hidden');
                    showBtn.classList.remove('hidden');
                    skipBtn.classList.remove('hidden');
                } else if (this.currentMode === 'select-ru' || this.currentMode === 'select-jp') {
                    optionsArea.classList.remove('hidden');
                    checkBtn.classList.add('hidden');
                    showBtn.classList.add('hidden');
                    skipBtn.classList.remove('hidden');
                }
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É
            nextCard() {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                const continueGroup = document.getElementById('continue-group');
                if (continueGroup) {
                    continueGroup.style.display = 'none';
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—ã—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ –≤–≤–æ–¥–∞
                if (this.currentMode === 'input-jp' || this.currentMode === 'input-ru') {
                    const inputAreaButtons = document.querySelector('#input-area .btn-group');
                    if (inputAreaButtons) {
                        inputAreaButtons.style.display = 'flex';
                    }
                }
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                document.getElementById('study-input').value = '';
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∏–ª–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞ (–¥–ª—è —Ä–µ–∂–∏–º–æ–≤ –≤—ã–±–æ—Ä–∞)
                const options = document.querySelectorAll('.option');
                options.forEach(option => {
                    option.className = 'option';
                    option.style.pointerEvents = 'auto';
                });
                
                // –°–∫—Ä—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
                const feedback = document.getElementById('study-feedback');
                feedback.classList.add('hidden');
                feedback.className = 'feedback hidden';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
                if (this.sessionProgress >= this.studySession.length) {
                    this.studySession = [...this.currentDeck.cards];
                    this.shuffleArray(this.studySession);
                    this.sessionProgress = 0;
                }

                // –ë–µ—Ä–µ–º —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ –∏–Ω–¥–µ–∫—Å—É
                this.currentCard = this.studySession[this.sessionProgress];
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∏–Ω–¥–µ–∫—Å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –≤—ã–∑–æ–≤–∞
                this.sessionProgress++;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                const progressPercent = (this.sessionProgress / this.studySession.length) * 100;
                const progressFill = document.getElementById('study-progress-fill');
                if (progressFill) {
                    progressFill.style.width = `${progressPercent}%`;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–æ–ø—Ä–æ—Å
                this.showQuestion();
            }

            // –ü–æ–∫–∞–∑ –≤–æ–ø—Ä–æ—Å–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
            showQuestion() {
                const prompt = document.getElementById('study-prompt');
                
                switch (this.currentMode) {
                    case 'input-jp':
                        prompt.innerHTML = `
                            <span class="prompt-text">–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ —è–ø–æ–Ω—Å–∫–∏–π: ${this.currentCard.russian}</span>
                        `;
                        break;
                    case 'input-ru':
                        prompt.innerHTML = `
                            <span class="prompt-text">–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ —Ä—É—Å—Å–∫–∏–π: ${this.currentCard.japanese}</span>
                            <button class="speak-btn" data-text="${this.currentCard.japanese}">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        `;
                        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
                        if (this.speechSettings.speakQuestion && !this.speechSettings.speakOnlyOnButton) {
                            setTimeout(() => {
                                this.speakJapaneseAuto(this.currentCard.japanese, 'question');
                            }, 500);
                        }
                        break;
                    case 'select-ru':
                        prompt.innerHTML = `
                            <span class="prompt-text">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –¥–ª—è: ${this.currentCard.japanese}</span>
                            <button class="speak-btn" data-text="${this.currentCard.japanese}">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        `;
                        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
                        if (this.speechSettings.speakQuestion && !this.speechSettings.speakOnlyOnButton) {
                            setTimeout(() => {
                                this.speakJapaneseAuto(this.currentCard.japanese, 'question');
                            }, 500);
                        }
                        this.showOptions('russian');
                        break;
                    case 'select-jp':
                        prompt.innerHTML = `
                            <span class="prompt-text">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è: ${this.currentCard.russian}</span>
                        `;
                        this.showOptions('japanese');
                        break;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è
                this.addSpeakButtonListeners();
            }

            // –ü–æ–∫–∞–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞
            showOptions(type) {
                const optionsArea = document.getElementById('options-area');
                optionsArea.innerHTML = '';

                // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π + 3 —Å–ª—É—á–∞–π–Ω—ã—Ö
                const correctAnswer = type === 'russian' ? this.currentCard.russian : this.currentCard.japanese;
                const otherCards = this.cards.filter(card => card.id !== this.currentCard.id);
                this.shuffleArray(otherCards);
                
                const options = [correctAnswer];
                for (let i = 0; i < 3 && i < otherCards.length; i++) {
                    const optionValue = type === 'russian' ? otherCards[i].russian : otherCards[i].japanese;
                    if (!options.includes(optionValue)) {
                        options.push(optionValue);
                    }
                }
                
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
                this.shuffleArray(options);
                
                // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
                options.forEach(option => {
                    const optionBtn = document.createElement('div');
                    optionBtn.className = 'option';
                    
                    if (type === 'japanese') {
                        optionBtn.innerHTML = `
                            <span>${option}</span>
                            <button class="speak-btn speak-btn-small" data-text="${option}">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        `;
                    } else {
                        optionBtn.textContent = option;
                    }
                    
                    optionBtn.addEventListener('click', () => this.selectOption(option, correctAnswer));
                    optionsArea.appendChild(optionBtn);
                });
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
                if (this.speechSettings.speakAllOptions && !this.speechSettings.speakOnlyOnButton && type === 'japanese') {
                    setTimeout(() => {
                        options.forEach((option, index) => {
                            setTimeout(() => {
                                this.speakJapaneseAuto(option, 'question');
                            }, index * 1500);
                        });
                    }, 1000);
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è –≤ –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö
                this.addSpeakButtonListeners();
            }

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è
            addSpeakButtonListeners() {
                document.querySelectorAll('.speak-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        
                        const text = btn.getAttribute('data-text');
                        if (text) {
                            // –ê–Ω–∏–º–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
                            btn.classList.add('speaking');
                            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                            
                            const wasSpoken = this.speakJapanese(text);
                            
                            if (!wasSpoken) {
                                setTimeout(() => {
                                    btn.classList.remove('speaking');
                                    btn.innerHTML = '<i class="fas fa-volume-up"></i>';
                                    if (!this.speechSupported) {
                                        alert('–û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Chrome –∏–ª–∏ Edge –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.');
                                    }
                                }, 100);
                            }
                        }
                    });
                });
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ —Å –≤–≤–æ–¥–æ–º
            checkAnswer() {
                const userAnswer = document.getElementById('study-input').value.trim().toLowerCase();
                if (!userAnswer) return;

                let correctAnswer;
                if (this.currentMode === 'input-jp') {
                    correctAnswer = this.currentCard.japanese.toLowerCase();
                } else if (this.currentMode === 'input-ru') {
                    correctAnswer = this.currentCard.russian.toLowerCase();
                }

                const isCorrect = userAnswer === correctAnswer;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏
                this.updateDeckStats(isCorrect);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
                this.showStudyFeedback(isCorrect, correctAnswer);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (–¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ)
                if (this.speechSettings.speakCorrectAnswer && !this.speechSettings.speakOnlyOnButton) {
                    setTimeout(() => {
                        if (this.currentMode === 'input-jp') {
                            this.speakJapaneseAuto(this.currentCard.japanese, 'correct-answer');
                        } else if (this.currentMode === 'input-ru') {
                            this.speakJapaneseAuto(this.currentCard.japanese, 'correct-answer');
                        }
                    }, 800);
                }
                
                // –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ —á–µ—Ä–µ–∑ –∫–æ—Ä–æ—Ç–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É
                setTimeout(() => {
                    this.nextCard();
                    // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                    document.getElementById('study-input').value = '';
                }, 1500);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ
                if (isCorrect) {
                    this.todayCount++;
                    localStorage.setItem('today-count', this.todayCount.toString());
                    this.updateDashboard();
                }
            }

            // –í—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞
            selectOption(selected, correct) {
                const isCorrect = selected === correct;
                
                // –ü–æ–º–µ—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
                const options = document.querySelectorAll('.option');
                options.forEach(opt => {
                    if (opt.textContent === selected || opt.querySelector('span')?.textContent === selected) {
                        opt.classList.add(isCorrect ? 'correct' : 'incorrect');
                    }
                    if (opt.textContent === correct || opt.querySelector('span')?.textContent === correct) {
                        opt.classList.add('correct');
                    }
                    opt.style.pointerEvents = 'none'; // –û—Ç–∫–ª—é—á–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∫–ª–∏–∫–∏
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞—Ä—Ç–æ—á–∫–∏
                this.updateDeckStats(isCorrect);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
                this.showStudyFeedback(isCorrect, correct);
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (–¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ)
                if (this.speechSettings.speakCorrectAnswer && !this.speechSettings.speakOnlyOnButton) {
                    setTimeout(() => {
                        if (this.currentMode === 'select-jp') {
                            this.speakJapaneseAuto(correct, 'correct-answer');
                        } else if (this.currentMode === 'select-ru') {
                            // –í —Ä–µ–∂–∏–º–µ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ –æ–∑–≤—É—á–∏–≤–∞–µ–º —è–ø–æ–Ω—Å–∫–æ–µ —Å–ª–æ–≤–æ
                            this.speakJapaneseAuto(this.currentCard.japanese, 'correct-answer');
                        }
                    }, 800);
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ
                if (isCorrect) {
                    this.todayCount++;
                    localStorage.setItem('today-count', this.todayCount.toString());
                    this.updateDashboard();
                }
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞—Ä—Ç–æ—á–∫–∏
            updateDeckStats(isCorrect) {
                const deckIndex = this.decks.findIndex(d => d.id === this.currentDeck.id);
                if (deckIndex === -1) return;

                const deck = this.decks[deckIndex];
                
                if (isCorrect) {
                    deck.stats.currentStreak++;
                    deck.stats.learned = Math.min(deck.stats.learned + 1, deck.cards.length);
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∞
                    if (deck.stats.learned >= deck.cards.length) {
                        deck.completed = true;
                        deck.stats.currentStreak = 0;
                        this.showFeedback('study-feedback', 'üéâ –ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –í—Å–µ —Å–ª–æ–≤–∞ –≤—ã—É—á–µ–Ω—ã!', 'correct');
                    }
                } else {
                    deck.stats.errors++;
                    deck.stats.currentStreak = 0;
                }
                
                deck.stats.lastStudy = new Date().toISOString();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                this.saveDecks();
                this.updateDeckInfo();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–∫–µ –∫–∞—Ä—Ç–æ—á–µ–∫
                if (document.getElementById('deck-selection').classList.contains('hidden')) {
                    this.renderDeckSelection();
                }
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç (–ø–æ–¥—Å–∫–∞–∑–∫–∞)
            showAnswer() {
                let correctAnswer;
                if (this.currentMode === 'input-jp') {
                    correctAnswer = this.currentCard.japanese;
                } else if (this.currentMode === 'input-ru') {
                    correctAnswer = this.currentCard.russian;
                }
                
                const feedback = document.getElementById('study-feedback');
                feedback.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}`;
                feedback.className = 'feedback incorrect';
                feedback.classList.remove('hidden');
                
                // –£–º–µ–Ω—å—à–∞–µ–º —Å–µ—Ä–∏—é –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –æ—Ç–≤–µ—Ç–∞
                this.currentDeck.stats.currentStreak = 0;
                this.saveDecks();
                this.updateDeckInfo();
                
                // –û–∑–≤—É—á–∏–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ
                if (this.speechSettings.speakCorrectAnswer && !this.speechSettings.speakOnlyOnButton) {
                    setTimeout(() => {
                        if (this.currentMode === 'input-jp' || this.currentMode === 'select-jp') {
                            this.speakJapaneseAuto(correctAnswer, 'correct-answer');
                        } else if (this.currentMode === 'input-ru' || this.currentMode === 'select-ru') {
                            this.speakJapaneseAuto(this.currentCard.japanese, 'correct-answer');
                        }
                    }, 500);
                }
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞
            showStudyFeedback(isCorrect, correctAnswer) {
                const feedback = document.getElementById('study-feedback');
                feedback.classList.remove('hidden');
                
                if (isCorrect) {
                    feedback.textContent = '‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
                    feedback.className = 'feedback correct';
                    
                    // –î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        feedback.classList.add('hidden');
                        this.nextCard();
                    }, 1500);
                    
                } else {
                    feedback.textContent = `‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}`;
                    feedback.className = 'feedback incorrect';
                    
                    // –î–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ - —Å–∫—Ä—ã–≤–∞–µ–º –æ–±—ã—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
                    if (this.currentMode === 'input-jp' || this.currentMode === 'input-ru') {
                        document.querySelector('#input-area .btn-group').style.display = 'none';
                    }
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
                    document.getElementById('continue-group').style.display = 'flex';
                }
            }

            // –°–º–µ–Ω–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
            changeDeck() {
                if (this.decks.length <= 1) {
                    alert('–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è —Å–º–µ–Ω—ã.');
                    return;
                }

                let newIndex;
                do {
                    newIndex = Math.floor(Math.random() * this.decks.length);
                } while (this.decks[newIndex].id === this.currentDeck.id);

                this.selectDeck(this.decks[newIndex]);
            }

            // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É
            stopDeck() {
                if (confirm('–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É?')) {
                    this.backToModes();
                }
            }

            // –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É —Ä–µ–∂–∏–º–æ–≤
            backToModes() {
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
                const continueGroup = document.getElementById('continue-group');
                if (continueGroup) {
                    continueGroup.style.display = 'none';
                }
                
                document.getElementById('study-area').classList.add('hidden');
                document.getElementById('deck-info').classList.add('hidden');
                document.getElementById('deck-selection').classList.add('hidden');
                document.getElementById('study-selection').classList.remove('hidden');
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è
                this.currentMode = null;
                this.currentDeck = null;
                this.currentCard = null;
                this.studySession = [];
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
                document.getElementById('study-input').value = '';
                document.getElementById('options-area').innerHTML = '';
                document.getElementById('study-feedback').classList.add('hidden');
            }

            // –ó–∞–∫–æ–Ω—á–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ
            stopStudy() {
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
                const continueGroup = document.getElementById('continue-group');
                if (continueGroup) {
                    continueGroup.style.display = 'none';
                }
                
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –≤—ã–±–æ—Ä—É —Ä–µ–∂–∏–º–æ–≤
                document.getElementById('study-area').classList.add('hidden');
                document.getElementById('deck-info').classList.add('hidden');
                document.getElementById('deck-selection').classList.add('hidden');
                document.getElementById('study-selection').classList.remove('hidden');
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è
                this.currentMode = null;
                this.currentDeck = null;
                this.currentCard = null;
                this.studySession = [];
                this.sessionProgress = 0;
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
                const progressFill = document.getElementById('study-progress-fill');
                if (progressFill) {
                    progressFill.style.width = '0%';
                }
                
                // –û—á–∏—â–∞–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                document.getElementById('study-input').value = '';
                document.getElementById('options-area').innerHTML = '';
                document.getElementById('study-feedback').classList.add('hidden');
                document.getElementById('study-prompt').textContent = '';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
                this.updateDashboard();
            }

            // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
            renderCardsList() {
                const container = document.getElementById('cards-list');
                const empty = document.getElementById('empty-cards');
                
                if (this.cards.length === 0) {
                    container.innerHTML = '';
                    empty.classList.remove('hidden');
                    return;
                }
                
                empty.classList.add('hidden');
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
                const sortedCards = [...this.cards].sort((a, b) => 
                    new Date(b.createdAt) - new Date(a.createdAt)
                );
                
                container.innerHTML = '';
                
                sortedCards.forEach(card => {
                    const cardItem = document.createElement('div');
                    cardItem.className = 'card-item';
                    cardItem.innerHTML = `
                        <div class="card-info">
                            <div>
                                <strong>${card.japanese}</strong> - ${card.russian}
                                <div style="font-size: 0.8rem; color: #999; margin-top: 3px;">
                                    ${new Date(card.createdAt).toLocaleDateString()}
                                </div>
                            </div>
                            <button class="speak-btn speak-btn-small" data-text="${card.japanese}">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                        <div class="card-actions">
                            <button class="btn btn-danger btn-small" data-id="${card.id}">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                    `;
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É–¥–∞–ª–µ–Ω–∏—è
                    const deleteBtn = cardItem.querySelector('button[data-id]');
                    deleteBtn.addEventListener('click', () => this.deleteCard(card.id));
                    
                    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–∑–≤—É—á–∏–≤–∞–Ω–∏—è
                    const speakBtn = cardItem.querySelector('.speak-btn');
                    speakBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.speakJapanese(card.japanese);
                    });
                    
                    container.appendChild(cardItem);
                });
            }

            // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–µ
            renderDecksList() {
                const container = document.getElementById('decks-list');
                container.innerHTML = '';
                
                if (this.decks.length === 0) {
                    container.innerHTML = '<p>–ù–µ—Ç —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫. –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏" –¥–ª—è –Ω–∞—á–∞–ª–∞.</p>';
                    return;
                }

                this.decks.forEach(deck => {
                    const card = document.createElement('div');
                    card.className = 'deck-card';
                    
                    const progress = deck.cards.length > 0 ? 
                        Math.round((deck.stats.learned / deck.cards.length) * 100) : 0;
                    
                    card.innerHTML = `
                        <h4>${deck.name}</h4>
                        <div>–°–ª–æ–≤–∞: ${deck.cards.length}</div>
                        <div>–ò–∑—É—á–µ–Ω–æ: ${deck.stats.learned}</div>
                        <div>–û—à–∏–±–æ–∫: ${deck.stats.errors}</div>
                        <div>–°–µ—Ä–∏—è: ${deck.stats.currentStreak}</div>
                        <div class="progress">
                            <div class="fill" style="width: ${progress}%"></div>
                        </div>
                        <div style="font-size: 0.9rem; color: #666; margin-top: 5px;">
                            ${deck.completed ? '‚úì –ó–∞–≤–µ—Ä—à–µ–Ω–∞' : '–í –ø—Ä–æ—Ü–µ—Å—Å–µ'}
                        </div>
                        <div class="card-preview" id="manage-preview-${deck.id}">
                            <!-- –°–ª–æ–≤–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å -->
                        </div>
                    `;
                    
                    container.appendChild(card);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ª–æ–≤
                    this.renderCardPreview(`manage-preview-${deck.id}`);
                });
            }

            // –†–µ–Ω–¥–µ—Ä –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ª–æ–≤ –≤ –∫–∞—Ä—Ç–æ—á–∫–µ (–¥–ª—è –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞)
            renderCardPreview(previewId) {
                const deckId = previewId.replace('manage-preview-', '');
                const deck = this.decks.find(d => d.id === deckId);
                if (!deck) return;

                const previewContainer = document.getElementById(previewId);
                previewContainer.innerHTML = '';
                
                deck.cards.forEach(card => {
                    const tag = document.createElement('span');
                    tag.className = 'card-tag';
                    tag.textContent = card.japanese;
                    previewContainer.appendChild(tag);
                });
            }

            // –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏
            deleteCard(id) {
                if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ä—Ç–æ—á–∫—É?')) {
                    this.cards = this.cards.filter(card => card.id !== id);
                    this.saveCards();
                    this.renderCardsList();
                    
                    // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
                    if (this.cards.length > 0) {
                        this.generateDecks();
                    } else {
                        this.decks = [];
                        this.saveDecks();
                    }
                    
                    if (this.currentTab === 'manage') {
                        this.renderDecksList();
                    }
                    
                    this.showFeedback('manage-feedback', '–ö–∞—Ä—Ç–æ—á–∫–∞ —É–¥–∞–ª–µ–Ω–∞', 'correct');
                }
            }

            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
            clearAllCards() {
                if (this.cards.length === 0) {
                    this.showFeedback('manage-feedback', '–ù–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è', 'incorrect');
                    return;
                }
                
                if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ ${this.cards.length} –∫–∞—Ä—Ç–æ—á–µ–∫?`)) {
                    this.cards = [];
                    this.decks = [];
                    this.deckStats = {};
                    this.saveCards();
                    this.saveDecks();
                    localStorage.removeItem('deck-stats');
                    
                    this.renderCardsList();
                    this.renderDecksList();
                    
                    this.showFeedback('manage-feedback', '–í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —É–¥–∞–ª–µ–Ω—ã', 'correct');
                }
            }

            // –≠–∫—Å–ø–æ—Ä—Ç –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ CSV
            exportCards() {
                if (this.cards.length === 0) {
                    this.showFeedback('manage-feedback', '–ù–µ—Ç –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞', 'incorrect');
                    return;
                }

                const csvContent = this.cards.map(card => 
                    `${card.japanese},${card.russian}`
                ).join('\n');
                
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `japanese-vocab-${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
                
                this.showFeedback('manage-feedback', '–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω', 'correct');
            }

            // –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
            showFeedback(elementId, message, type, timeout = 5000) {
                const feedback = document.getElementById(elementId);
                feedback.textContent = message;
                feedback.className = `feedback ${type}`;
                feedback.classList.remove('hidden');
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
                setTimeout(() => {
                    feedback.classList.add('hidden');
                }, timeout);
            }

            // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è –º–∞—Å—Å–∏–≤–∞
            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            continueAfterMistake() {
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
                document.getElementById('continue-group').style.display = 'none';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
                const feedback = document.getElementById('study-feedback');
                feedback.classList.add('hidden');
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—ã—á–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
                if (this.currentMode === 'input-jp' || this.currentMode === 'input-ru') {
                    document.querySelector('#input-area .btn-group').style.display = 'flex';
                }
                
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
                this.nextCard();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        document.addEventListener('DOMContentLoaded', () => {
            const app = new VocabularyApp();
            
            // –ü—Ä–∏–º–µ—Ä –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            if (app.cards.length === 0) {
                setTimeout(() => {
                    if (confirm('–î–æ–±–∞–≤–∏—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã?')) {
                        const demoCards = [
                            ['„Å≠„Åì', '–∫–æ—à–∫–∞'],
                            ['„ÅÑ„Å¨', '—Å–æ–±–∞–∫–∞'],
                            ['„Å®„Çä', '–ø—Ç–∏—Ü–∞'],
                            ['„Åï„Åã„Å™', '—Ä—ã–±–∞'],
                            ['„Å≤„Çã', '–¥–µ–Ω—å'],
                            ['„Çà„Çã', '–Ω–æ—á—å'],
                            ['„ÅÇ„ÇÅ', '–¥–æ–∂–¥—å'],
                            ['„ÇÜ„Åç', '—Å–Ω–µ–≥'],
                            ['„Åã„Åú', '–≤–µ—Ç–µ—Ä'],
                            ['„Å≤', '—Å–æ–ª–Ω—Ü–µ'],
                            ['„Å§„Åç', '–ª—É–Ω–∞'],
                            ['„Åª„Åó', '–∑–≤–µ–∑–¥–∞'],
                            ['„Åø„Åö', '–≤–æ–¥–∞'],
                            ['„ÇÑ„Åæ', '–≥–æ—Ä–∞'],
                            ['„Åó„Åã', '–æ–ª–µ–Ω—å'],
                            ['„ÅÜ„Åæ', '–ª–æ—à–∞–¥—å'],
                            ['„ÅÜ„Åï„Åé', '–∫—Ä–æ–ª–∏–∫'],
                            ['„Åã„ÇÅ', '—á–µ—Ä–µ–ø–∞—Ö–∞'],
                            ['„Å∏„Å≥', '–∑–º–µ—è'],
                            ['„Å®„Çä', '–ø—Ç–∏—Ü–∞']
                        ];
                        
                        demoCards.forEach(([jp, ru]) => app.addCard(jp, ru));
                        alert('–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã! –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ.');
                        app.switchTab('dashboard');
                    }
                }, 500);
            }
            
            // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', () => {
                if (window.innerWidth > 768) {
                    document.getElementById('desktop-tabs').style.display = 'flex';
                } else {
                    document.getElementById('desktop-tabs').style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
